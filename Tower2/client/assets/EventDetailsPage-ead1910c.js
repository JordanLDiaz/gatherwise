import{k as y,A as c,T as f,l as i,_ as S,u as A,m as B,o as N,c as h,P as l,t as w,a as m,b as v,d as t,i as u,n as C,f as g,F as k,e as T,w as j,q as I,v as D,s as P,p as M,j as L}from"./index-5bf7c8f4.js";class O{async getTicketsByEvent(s){const a=await y.get(`api/events/${s}/tickets`);c.attendees=a.data.map(e=>new f(e)),i.log("[ATTENDEES IN APPSTATE]",c.attendees)}async buyTicket(s){const a=await y.post("api/tickets",s);i.log("[BUYING TICKET]",a.data);const e=new f(a.data);c.attendees.push(e),i.log("[Tickets in appstate]",c.attendees)}async sellTicket(s){const a=await y.delete("api/tickets/"+s);i.log("[SELLING TICKET]",a.data),c.attendees=c.attendees.filter(e=>e.id!=s),i.log("[ATTENDEES IN APPSTATE]",c.attendees)}}const E=new O;class x{constructor(s){this.id=s.id,this.creatorId=s.creatorId,this.eventId=s.eventId,this.body=s.body,this.creator=s.creator,this.postedOn=new Date(s.postedOn).toDateString()}}class V{async getCommentsByEvent(s){const a=await y.get("api/events/"+s+"/comments");c.comments=a.data.map(e=>new x(e))}async postComment(s){const a=await y.post("api/comments",s),e=new x(a.data);c.comments.unshift(e),i.log("[COMMENTS IN APPSTATE]",c.comments)}async removeComment(s){const a=await y.delete("api/comments/"+s);i.log("[REMOVING COMMENT]",a.data);const e=c.comments.findIndex(p=>p.id==s);e<0||c.comments.splice(e,1)}}const b=new V;const F={setup(){const r=A(),s=B({});async function a(){try{const n=r.params.eventId;await w.getEventById(n)}catch(n){i.error(n),l.error(n.message)}}async function e(){try{const n=r.params.eventId;await E.getTicketsByEvent(n)}catch(n){i.error(n),l.error(n.message)}}async function p(){try{const n=r.params.eventId;await b.getCommentsByEvent(n)}catch(n){i.error(n),l.error(n.message)}}return N(()=>{a(),e(),p()}),{editable:s,activeEvent:h(()=>c.activeEvent),attendees:h(()=>c.attendees),comments:h(()=>c.comments),account:h(()=>c.account),isAttending:h(()=>c.attendees.find(n=>n.accountId==c.account.id)),async postComment(){try{const n=s.value;i.log(n),n.eventId=r.params.eventId,await b.postComment(n),s.value={},l.toast("You posted a new comment!","success","center")}catch(n){i.error(n),l.error(n.message)}},async removeComment(n){try{await l.confirm("Are you sure you want to remove this comment?","This cannot be undone!")&&await b.removeComment(n)}catch(d){i.error(d),l.error(d.message)}},async buyTicket(){try{const d={eventId:r.params.eventId};await E.buyTicket(d),c.activeEvent.ticketCount++,l.toast("Ticket received!","success","center")}catch(n){i.error(n),l.error(n.message)}},async sellTicket(){try{const d=c.attendees.find(o=>o.accountId==c.account.id).id;await E.sellTicket(d),c.activeEvent.ticketCount--,l.toast("Ticket sold!","success","center")}catch(n){i.error(n),l.error(n.message)}},async cancelEvent(){try{if(!await l.confirm())return;const d=r.params.eventId;await w.cancelEvent(d)}catch(n){i.error(n),l.error(n.message)}}}}},_=r=>(M("data-v-7cb6c1eb"),r=r(),L(),r),G={key:0,class:"container"},R={class:"row justify-content-center my-3"},q={class:"col-11"},K={class:"position-relative"},U=["src","alt"],Y={class:"glass"},J={class:"row"},W={class:"col-5 d-flex"},z={class:"align-item-center"},H=["src"],Q={class:"col-7"},X=_(()=>t("h1",{class:"px-3 text-end"},"...",-1)),Z={class:"d-flex justify-content-between"},$={class:"d-flex justify-content-between"},tt=_(()=>t("p",null,"Starting at 9:00 am",-1)),et={class:"row justify-content-evenly pt-3"},nt={key:0,class:"col-3 bg-primary d-flex align-items-center justify-content-center"},st=_(()=>t("p",{class:"mb-0"},"Event Full!",-1)),ct=[st],ot={key:1,class:"col-3 bg-primary d-flex align-items-center justify-content-center"},it=_(()=>t("p",{class:"mb-0"},"Event Canceled!",-1)),at=[it],rt={key:2,class:"col-3 bg-primary d-flex align-items-center justify-content-center"},lt={class:"mb-0"},dt={key:3,class:"col-4 text-center"},mt={key:4,class:"col-4 text-center"},vt={class:"col-4 text-center"},_t=_(()=>t("span",{class:"mdi mdi-close-outline"}," Cancel Event",-1)),ut=[_t],yt={class:"row mt-3 mx-3"},ht={class:"p-2 attendees rounded"},pt=_(()=>t("p",null,"See who's attending",-1)),gt=["src","title"],Et={class:"row px-5 py-3"},bt={class:"comments p-5"},ft=_(()=>t("div",{class:"d-flex justify-content-between"},[t("h5",null,"What are people saying?"),t("p",null,"Join the conversation!")],-1)),wt={class:"form-floating mb-3"},kt=_(()=>t("label",{for:"floatingInput"},"Leave a comment...",-1)),Tt=_(()=>t("div",{class:"text-end mb-2"},[t("button",{type:"submit",class:"btn btn-outline mx-1"},[t("span",{class:"mdi mdi-plus-box"}),C("Comment")])],-1)),It={class:"a-comment mx-5 my-3 px-4 d-flex justify-content-between rounded d-flex"},xt={class:"col-1 d-flex justify-content-center align-items-center"},Ct=["src","title"],St={class:"col-11 mt-2 px-2"},At={class:"text-white"},Bt=["onClick"],Nt={class:"btn btn-outline-purple"},jt=_(()=>t("span",{class:"mdi mdi-trash-can",title:"Remove comment"},null,-1)),Dt=[jt];function Pt(r,s,a,e,p,n){var d;return e.activeEvent?(m(),v("div",G,[t("section",R,[t("div",q,[t("div",K,[t("img",{src:e.activeEvent.coverImg,alt:e.activeEvent.name,class:"img-fluid blur-img"},null,8,U),t("div",Y,[t("div",J,[t("div",W,[t("div",z,[t("img",{src:e.activeEvent.coverImg,class:"img-fluid main-img"},null,8,H)])]),t("div",Q,[X,t("div",Z,[t("h3",null,u(e.activeEvent.name),1),t("p",null,u(e.activeEvent.startDate),1)]),t("div",$,[t("p",null,u(e.activeEvent.location),1),tt]),t("p",null,u(e.activeEvent.description),1)])]),t("div",et,[e.activeEvent.ticketCount==e.activeEvent.capacity&&!e.activeEvent.isCanceled?(m(),v("div",nt,ct)):e.activeEvent.isCanceled?(m(),v("div",ot,at)):(m(),v("div",rt,[t("p",lt,[t("b",null,u(e.activeEvent.capacity-e.activeEvent.ticketCount),1),C(" spots remaining! ")])])),!e.isAttending&&!e.activeEvent.isCanceled&&e.activeEvent.ticketCount!=e.activeEvent.capacity?(m(),v("div",dt,[t("button",{onClick:s[0]||(s[0]=o=>e.buyTicket()),type:"button",class:"btn btn-outline hvr-pulse"},"Buy Ticket")])):g("",!0),e.isAttending&&!e.activeEvent.isCanceled?(m(),v("div",mt,[t("button",{onClick:s[1]||(s[1]=o=>e.sellTicket()),type:"button",class:"btn btn-outline"},"Sell Ticket")])):g("",!0),t("div",vt,[e.account.id&&e.account.id==((d=e.activeEvent)==null?void 0:d.creatorId)&&!e.activeEvent.isCanceled?(m(),v("button",{key:0,onClick:s[2]||(s[2]=o=>e.cancelEvent()),class:"btn btn-outline"},ut)):g("",!0)])])])])])]),t("section",yt,[t("div",ht,[pt,(m(!0),v(k,null,T(e.attendees,o=>(m(),v("img",{src:o.profile.picture,title:o.profile.name,class:"img-fluid rounded-circle",style:{height:"50px",width:"50px"}},null,8,gt))),256))])]),t("section",Et,[t("div",bt,[ft,t("form",{onSubmit:s[4]||(s[4]=j(o=>e.postComment(),["prevent"]))},[t("div",wt,[I(t("textarea",{"onUpdate:modelValue":s[3]||(s[3]=o=>e.editable.body=o),type:"text",class:"form-control",id:"floatingInput","aria-describedby":"Leave a comment",rows:"4",required:""},null,512),[[D,e.editable.body]]),kt]),Tt],32),(m(!0),v(k,null,T(e.comments,o=>(m(),v("div",It,[t("div",xt,[t("img",{src:o.creator.picture,title:o.creator.name,class:"img-fluid rounded-circle",style:{height:"60px",width:"60px"}},null,8,Ct)]),t("div",St,[t("h5",null,u(o.creator.name),1),t("p",At,u(o.body),1),t("div",{onClick:Mt=>e.removeComment(o.id),class:"text-end"},[I(t("button",Nt,Dt,512),[[P,o.creatorId==e.account.id]])],8,Bt)])]))),256))])])])):g("",!0)}const Ot=S(F,[["render",Pt],["__scopeId","data-v-7cb6c1eb"]]);export{Ot as default};
